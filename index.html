<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Analyse-Tool – Finale XML mit strukturierter KI-Anweisung</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 960px; margin: auto; padding: 20px; }
    textarea, select, input[type="text"] {
      width: 100%; margin-top: 5px; padding: 6px; font-family: monospace;
    }
    textarea { height: 160px; }
    .analyse-block { margin-bottom: 30px; border-top: 1px solid #ccc; padding-top: 20px; }
    .button-group { margin-top: 10px; display: flex; gap: 10px; flex-wrap: wrap; }
    label span { font-weight: normal; font-size: 14px; margin-left: 10px; color: #555; }
    h2 { margin-top: 40px; }
  </style>
</head>
<body>
  <h1>Analyse-Tool für Transkript & Anmoderation 002</h1>

  <label for="beitragstitel">Beitragstitel:</label>
  <input type="text" id="beitragstitel" placeholder="z. B. Sanierung des Großherzoglichen Palais" />

  <label for="ressort">Ressort:</label>
  <select id="ressort">
    <option value="">– Bitte wählen –</option>
    <option>Politik</option>
    <option>Wirtschaft</option>
    <option>Kultur</option>
    <option>Sport</option>
    <option>Wissen</option>
    <option>Gesellschaft</option>
    <option>Panorama</option>
    <option>Digitales</option>
    <option>Verbraucher</option>
    <option>Gesundheit</option>
    <option>Bildung</option>
    <option>Umwelt</option>
    <option>Verkehr</option>
    <option>Justiz</option>
    <option>Ausland</option>
  </select>

  <label for="tags">Tags (kommagetrennt):</label>
  <input type="text" id="tags" placeholder="z. B. Sanierung, Denkmal, Neustrelitz, Hotel" />

  <div class="analyse-block">
    <h2>Transkript</h2>
    <label for="transkript">Text <span id="charCountTranskript">0 Zeichen</span></label>
    <textarea id="transkript" placeholder="Geben Sie hier das Transkript ein..."></textarea>

    <label for="weightTranskript">Gewichtung:</label>
    <select id="weightTranskript">
      <option value="0">0 %</option>
      <option value="25">25 %</option>
      <option value="50" selected>50 %</option>
      <option value="75">75 %</option>
      <option value="100">100 %</option>
    </select>
  </div>

  <div class="analyse-block">
    <h2>Anmoderation</h2>
    <label for="anmoderation">Text <span id="charCountAnmoderation">0 Zeichen</span></label>
    <textarea id="anmoderation" placeholder="Geben Sie hier die Anmoderation ein..."></textarea>

    <label for="weightAnmoderation">Gewichtung:</label>
    <select id="weightAnmoderation">
      <option value="0">0 %</option>
      <option value="25">25 %</option>
      <option value="50" selected>50 %</option>
      <option value="75">75 %</option>
      <option value="100">100 %</option>
    </select>
  </div>

  <h2>Finale XML-Ausgabe</h2>
  <textarea id="finalXml" placeholder="Hier erscheint das finale XML..."></textarea>
  <div class="button-group">
    <button onclick="copyToClipboard()">In Zwischenablage kopieren</button>
    <button onclick="downloadXML()">XML herunterladen</button>
    <button onclick="generateFinalXML()">Finales XML erstellen</button>
  </div>

  <script>
    const finalXmlOutput = document.getElementById("finalXml");

    function escapeXml(unsafe) {
      return unsafe
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&apos;");
    }

    function generateTimestamp() {
      const now = new Date();
      const d = now.toLocaleDateString("de-DE");
      const t = now.toLocaleTimeString("de-DE");
      return `${d} ${t}`;
    }

    function updateCharCount(id) {
      const count = document.getElementById(id).value.length;
      document.getElementById("charCount" + id.charAt(0).toUpperCase() + id.slice(1)).textContent = `${count} Zeichen`;
    }

    document.getElementById("transkript").addEventListener("input", () => updateCharCount("transkript"));
    document.getElementById("anmoderation").addEventListener("input", () => updateCharCount("anmoderation"));

    function generateFinalXML() {
      const id = "beitrag-" + generateTimestamp();
      const titel = escapeXml(document.getElementById("beitragstitel").value.trim());
      const ressort = escapeXml(document.getElementById("ressort").value);
      const tags = escapeXml(document.getElementById("tags").value.trim());

      const transkript = escapeXml(document.getElementById("transkript").value.trim());
      const anmoderation = escapeXml(document.getElementById("anmoderation").value.trim());
      const weightT = document.getElementById("weightTranskript").value;
      const weightA = document.getElementById("weightAnmoderation").value;

      const xml = `<?xml version="1.0" encoding="UTF-8"?>
<online-ausgabe version="1.0">
  <anweisung-fuer-ki>
    <beschreibung>Bitte analysiere dieses XML vollständig.</beschreibung>
    <aufgaben>
      <aufgabe>
        <ziel>Analyse der Analysearten</ziel>
        <schritte>
          <schritt nummer="2">Zentrale Fakten</schritt>
          <schritt nummer="3">Zentrales Thema</schritt>
          <schritt nummer="4">Informative Absicht</schritt>
          <schritt nummer="5">Beteiligte Personen oder Institutionen</schritt>
          <schritt nummer="6">Prognose zum Beitragsinhalt (falls vorhanden)</schritt>
        </schritte>
        <gilt-fuer>
          <quelle>Transkript</quelle>
          <quelle>Anmoderation</quelle>
        </gilt-fuer>
      </aufgabe>
      <aufgabe>
        <ziel>Erstellung redaktioneller Online-Elemente</ziel>
        <elemente>
          <ueberschrift max-laenge="60">Klare Keywords, keine Füllwörter</ueberschrift>
          <kurzbeschreibung max-laenge="150">Prägnant, faktenbasiert, mit klarer Aussage</kurzbeschreibung>
          <keywords max="10">Thematisch relevant, trennscharf</keywords>
          <themen max="5">Übergeordnete Themenfelder</themen>
        </elemente>
      </aufgabe>
      <aufgabe>
        <ziel>Ausgabeformat der Ergebnisse</ziel>
        <formate>
          <format typ="html">Lesefreundlich, strukturiert in Boxen</format>
          <format typ="text">Klar gegliedert mit Zwischenüberschriften</format>
        </formate>
      </aufgabe>
    </aufgaben>
    <hinweise>
      <hinweis>Vermeide CDATA</hinweis>
      <hinweis>Halte dich an die Ausgabevorgaben in den XML-Attributen</hinweis>
    </hinweise>
  </anweisung-fuer-ki>

  <quelle>
    <id>${id}</id>
    <art>TV-Beitrag</art>
    <titel>${titel}</titel>
    <themenvorgabe>
      <ressort>${ressort}</ressort>
      <tags>${tags}</tags>
    </themenvorgabe>
    <analysearten>
      <transkript gewichtung="${weightT}">
        <originaltext>${transkript}</originaltext>
        <analyse>
          <schritt nummer="2"></schritt>
          <schritt nummer="3"></schritt>
          <schritt nummer="4"></schritt>
          <schritt nummer="5"></schritt>
        </analyse>
      </transkript>
      <anmoderation gewichtung="${weightA}">
        <originaltext>${anmoderation}</originaltext>
        <analyse>
          <schritt nummer="2"></schritt>
          <schritt nummer="3"></schritt>
          <schritt nummer="4"></schritt>
          <schritt nummer="5"></schritt>
          <schritt nummer="6"></schritt>
        </analyse>
      </anmoderation>
    </analysearten>
  </quelle>

  <editorial-metadata>
    <ueberschrift länge-max="60"></ueberschrift>
    <kurzbeschreibung länge-max="150"></kurzbeschreibung>
    <seo>
      <keywords max="10">
        <keyword></keyword>
      </keywords>
      <themen max="5">
        <thema></thema>
      </themen>
    </seo>
  </editorial-metadata>
</online-ausgabe>`;

      finalXmlOutput.value = xml;
    }

    function copyToClipboard() {
      finalXmlOutput.select();
      document.execCommand("copy");
    }

    function downloadXML() {
      const blob = new Blob([finalXmlOutput.value], { type: "application/xml" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "finale-online-ausgabe.xml";
      a.click();
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>